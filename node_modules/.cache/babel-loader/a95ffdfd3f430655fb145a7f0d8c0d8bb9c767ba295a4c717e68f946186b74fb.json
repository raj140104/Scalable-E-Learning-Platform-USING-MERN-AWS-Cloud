{"ast":null,"code":"import{useState}from\"react\";import{useForm}from\"react-hook-form\";import{toast}from\"react-hot-toast\";import{IoAddCircleOutline}from\"react-icons/io5\";import{MdNavigateNext}from\"react-icons/md\";import{useDispatch,useSelector}from\"react-redux\";import{createSection,updateSection}from\"../../../../../services/operations/courseDetailsAPI\";import{setCourse,setEditCourse,setStep}from\"../../../../../slices/courseSlice\";import IconBtn from\"../../../../common/IconBtn\";import NestedView from\"./NestedView\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function CourseBuilderForm(){const{register,handleSubmit,setValue,formState:{errors}}=useForm();const{course}=useSelector(state=>state.course);const{token}=useSelector(state=>state.auth);const[loading,setLoading]=useState(false);const[editSectionName,setEditSectionName]=useState(null);const dispatch=useDispatch();// handle form submission\nconst onSubmit=async data=>{// console.log(data)\nsetLoading(true);let result;if(editSectionName){result=await updateSection({sectionName:data.sectionName,sectionId:editSectionName,courseId:course._id},token);// console.log(\"edit\", result)\n}else{result=await createSection({sectionName:data.sectionName,courseId:course._id},token);}if(result){// console.log(\"section result\", result)\ndispatch(setCourse(result));setEditSectionName(null);setValue(\"sectionName\",\"\");}setLoading(false);};const cancelEdit=()=>{setEditSectionName(null);setValue(\"sectionName\",\"\");};const handleChangeEditSectionName=(sectionId,sectionName)=>{if(editSectionName===sectionId){cancelEdit();return;}setEditSectionName(sectionId);setValue(\"sectionName\",sectionName);};const goToNext=()=>{if(course.courseContent.length===0){toast.error(\"Please add atleast one section\");return;}if(course.courseContent.some(section=>section.subSection.length===0)){toast.error(\"Please add atleast one lecture in each section\");return;}dispatch(setStep(3));};const goBack=()=>{dispatch(setStep(1));dispatch(setEditCourse(true));};return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-8 rounded-md border-[1px] border-richblack-700 bg-richblack-800 p-6\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-semibold text-richblack-5\",children:\"Course Builder\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit(onSubmit),className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col space-y-2\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"text-sm text-richblack-5\",htmlFor:\"sectionName\",children:[\"Section Name \",/*#__PURE__*/_jsx(\"sup\",{className:\"text-pink-200\",children:\"*\"})]}),/*#__PURE__*/_jsx(\"input\",{id:\"sectionName\",disabled:loading,placeholder:\"Add a section to build your course\",...register(\"sectionName\",{required:false}),className:\"form-style w-full\"}),errors.sectionName&&/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 text-xs tracking-wide text-pink-200\",children:\"Section name is required\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-end gap-x-4\",children:[/*#__PURE__*/_jsx(IconBtn,{type:\"submit\",disabled:loading,text:editSectionName?\"Edit Section Name\":\"Create Section\",outline:true,children:/*#__PURE__*/_jsx(IoAddCircleOutline,{size:20,className:\"text-yellow-50\"})}),editSectionName&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:cancelEdit,className:\"text-sm text-richblack-300 underline\",children:\"Cancel Edit\"})]})]}),course.courseContent.length>0&&/*#__PURE__*/_jsx(NestedView,{handleChangeEditSectionName:handleChangeEditSectionName}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-end gap-x-3\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:goBack,className:`flex cursor-pointer items-center gap-x-2 rounded-md bg-richblack-300 py-[8px] px-[20px] font-semibold text-richblack-900`,children:\"Back\"}),/*#__PURE__*/_jsx(IconBtn,{disabled:loading,text:\"Next\",onclick:goToNext,children:/*#__PURE__*/_jsx(MdNavigateNext,{})})]})]});}","map":{"version":3,"names":["useState","useForm","toast","IoAddCircleOutline","MdNavigateNext","useDispatch","useSelector","createSection","updateSection","setCourse","setEditCourse","setStep","IconBtn","NestedView","jsx","_jsx","jsxs","_jsxs","CourseBuilderForm","register","handleSubmit","setValue","formState","errors","course","state","token","auth","loading","setLoading","editSectionName","setEditSectionName","dispatch","onSubmit","data","result","sectionName","sectionId","courseId","_id","cancelEdit","handleChangeEditSectionName","goToNext","courseContent","length","error","some","section","subSection","goBack","className","children","htmlFor","id","disabled","placeholder","required","type","text","outline","size","onClick","onclick"],"sources":["C:/Users/rites/Downloads/7th sem/7th Sem Project/Study-pilot/Study-pilot/src/components/core/Dashboard/AddCourse/CourseBuilder/CourseBuilderForm.jsx"],"sourcesContent":["import { useState } from \"react\"\nimport { useForm } from \"react-hook-form\"\nimport { toast } from \"react-hot-toast\"\nimport { IoAddCircleOutline } from \"react-icons/io5\"\nimport { MdNavigateNext } from \"react-icons/md\"\nimport { useDispatch, useSelector } from \"react-redux\"\n\nimport {\n  createSection,\n  updateSection,\n} from \"../../../../../services/operations/courseDetailsAPI\"\nimport {\n  setCourse,\n  setEditCourse,\n  setStep,\n} from \"../../../../../slices/courseSlice\"\nimport IconBtn from \"../../../../common/IconBtn\"\nimport NestedView from \"./NestedView\"\n\nexport default function CourseBuilderForm() {\n  const {\n    register,\n    handleSubmit,\n    setValue,\n    formState: { errors },\n  } = useForm()\n\n  const { course } = useSelector((state) => state.course)\n  const { token } = useSelector((state) => state.auth)\n  const [loading, setLoading] = useState(false)\n  const [editSectionName, setEditSectionName] = useState(null)\n  const dispatch = useDispatch()\n\n  // handle form submission\n  const onSubmit = async (data) => {\n    // console.log(data)\n    setLoading(true)\n\n    let result\n\n    if (editSectionName) {\n      result = await updateSection(\n        {\n          sectionName: data.sectionName,\n          sectionId: editSectionName,\n          courseId: course._id,\n        },\n        token\n      )\n      // console.log(\"edit\", result)\n    } else {\n      result = await createSection(\n        {\n          sectionName: data.sectionName,\n          courseId: course._id,\n        },\n        token\n      )\n    }\n    if (result) {\n      // console.log(\"section result\", result)\n      dispatch(setCourse(result))\n      setEditSectionName(null)\n      setValue(\"sectionName\", \"\")\n    }\n    setLoading(false)\n  }\n\n  const cancelEdit = () => {\n    setEditSectionName(null)\n    setValue(\"sectionName\", \"\")\n  }\n\n  const handleChangeEditSectionName = (sectionId, sectionName) => {\n    if (editSectionName === sectionId) {\n      cancelEdit()\n      return\n    }\n    setEditSectionName(sectionId)\n    setValue(\"sectionName\", sectionName)\n  }\n\n  const goToNext = () => {\n    if (course.courseContent.length === 0) {\n      toast.error(\"Please add atleast one section\")\n      return\n    }\n    if (\n      course.courseContent.some((section) => section.subSection.length === 0)\n    ) {\n      toast.error(\"Please add atleast one lecture in each section\")\n      return\n    }\n    dispatch(setStep(3))\n  }\n\n  const goBack = () => {\n    dispatch(setStep(1))\n    dispatch(setEditCourse(true))\n  }\n\n  return (\n    <div className=\"space-y-8 rounded-md border-[1px] border-richblack-700 bg-richblack-800 p-6\">\n      <p className=\"text-2xl font-semibold text-richblack-5\">Course Builder</p>\n      <form onSubmit={handleSubmit(onSubmit)} className=\"space-y-4\">\n        <div className=\"flex flex-col space-y-2\">\n          <label className=\"text-sm text-richblack-5\" htmlFor=\"sectionName\">\n            Section Name <sup className=\"text-pink-200\">*</sup>\n          </label>\n          <input\n            id=\"sectionName\"\n            disabled={loading}\n            placeholder=\"Add a section to build your course\"\n            {...register(\"sectionName\", { required: false })}\n            className=\"form-style w-full\"\n          />\n          {errors.sectionName && (\n            <span className=\"ml-2 text-xs tracking-wide text-pink-200\">\n              Section name is required\n            </span>\n          )}\n        </div>\n        <div className=\"flex items-end gap-x-4\">\n          <IconBtn\n            type=\"submit\"\n            disabled={loading}\n            text={editSectionName ? \"Edit Section Name\" : \"Create Section\"}\n            outline={true}\n          >\n            <IoAddCircleOutline size={20} className=\"text-yellow-50\" />\n          </IconBtn>\n          {editSectionName && (\n            <button\n              type=\"button\"\n              onClick={cancelEdit}\n              className=\"text-sm text-richblack-300 underline\"\n            >\n              Cancel Edit\n            </button>\n          )}\n        </div>\n      </form>\n      {course.courseContent.length > 0 && (\n        <NestedView handleChangeEditSectionName={handleChangeEditSectionName} />\n      )}\n      {/* Next Prev Button */}\n      <div className=\"flex justify-end gap-x-3\">\n        <button\n          onClick={goBack}\n          className={`flex cursor-pointer items-center gap-x-2 rounded-md bg-richblack-300 py-[8px] px-[20px] font-semibold text-richblack-900`}\n        >\n          Back\n        </button>\n        <IconBtn disabled={loading} text=\"Next\" onclick={goToNext}>\n          <MdNavigateNext />\n        </IconBtn>\n      </div>\n    </div>\n  )\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}